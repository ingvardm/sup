define("ms2h",[],function(){return{getHMS:function(e){var t=Math.floor(e/1e3),n=Math.floor(t/3600),r=Math.floor((t-n*3600)/60),i=t-(n*3600+r*60),s;return i<=9?i="0"+i:null,r<=9?r="0"+r:null,n<=9?n="0"+n:null,s=n+":"+r+":"+i,s},getDMYfromTimestamp:function(e){var t=new Date(e),n=t.getDate(),r=t.getMonth()+1,i=t.getFullYear();return n+"/"+(r<=9?r="0"+r:null)+"/"+i},getTime:function(e){var t=new Date(e),n=t.getHours(),r=t.getMinutes();return(n<=9?"0"+n:n)+":"+(r<=9?"0"+r:r)}}}),define("server",[],function(){var place_selector=document.querySelector("select");return{getStats:function(callback){var req=new XMLHttpRequest,data;req.open("GET","/metrics",!0),req.onreadystatechange=function(aEvt){req.readyState==4&&(req.status==200?(data=eval("("+req.responseText+")"),callback(data)):alert("Error loading results.json"))},req.send(null)},postJSON:function(e){var t=new XMLHttpRequest;t.open("POST","/metrics",!0),t.setRequestHeader("Content-type","application/json;"),t.send(e)},postMetricsData:function(){var e={date:Date(),timestamp:Date.now(),place:place_selector.value,metrics:{}};[].forEach.call(document.querySelector(".metrics").children,function(t){e.metrics[t.dataset.role]=parseInt(t.querySelector(".done").getAttribute("data-time"),10)}),this.postJSON(JSON.stringify(e))}}}),define("UI",[],function(){var e=document.querySelector("#pages"),t=document.querySelector("select"),n=document.querySelector(".go").querySelector(".button"),r=document.querySelector(".stats").querySelector(".button"),i=document.querySelector(".stats").querySelector(".statsList"),s=document.querySelector(".reset"),o=document.querySelector(".metrics").querySelectorAll(".button"),u=document.querySelector(".welcome"),a=[],f=document.querySelector(".curDate");if(typeof sessionStorage.times!="undefined")var a=sessionStorage.times.split(",");var l={addEvLis:function(){t.addEventListener("change",this.onPlaceChanged),n.addEventListener("click",this.onGoBtnClick),s.addEventListener("click",this.onResetBtnClick);var e=this;[].forEach.call(o,function(t){t.addEventListener("click",e.onMetricBtnClick())})},onPlaceChanged:function(){l.displayStats(),i.classList.add("hidden"),this.value?(n.classList.remove("hidden"),r.classList.remove("hidden")):(n.classList.add("hidden"),r.classList.add("hidden"))},onGoBtnClick:function(){sessionStorage.place=t.value;var n=new Date;require(["ms2h"],function(e){f.innerHTML="Today is: "+e.getDMYfromTimestamp(n)}),u.innerHTML="Welcome to "+t.value,e.classList.toggle("active");var r=document.querySelector(".hiddenR");r.classList.toggle("hiddenR")},onResetBtnClick:function(){confirm("Are you sure ?")&&(location.reload(!0),sessionStorage.clear())},onMetricBtnClick:function(){return function(){if(this.classList.contains("done"))return;this.classList.toggle("done");var e=this,t=Date.now();require(["ms2h"],function(n){e.innerHTML+="@ "+n.getTime(t)}),this.setAttribute("data-time",t),require(["server"],function(e){if(l.measurmentsDone()){e.postMetricsData();return}});var n=document.querySelector(".hiddenR");n.classList.toggle("hiddenR"),a.push(t),sessionStorage.setItem("times",a)}},displayStats:function(){require(["server"],function(e){var t=e.getStats(l.onStatsDataReturned)})},onStatsDataReturned:function(e){var n=0,r=0,i=0;for(var s=0;s<e.visits.length;s++)e.visits[s].place==t.value&&(n=e.visits[s].timestamp,r==0&&i==0?(r=e.visits[s].metrics.gotOut-e.visits[s].metrics.gotIN,i=e.visits[s].metrics.gotFood-e.visits[s].metrics.placedOrder):(r=Math.floor((r+e.visits[s].metrics.gotOut-e.visits[s].metrics.gotIN)/2),i=Math.floor((i+e.visits[s].metrics.gotFood-e.visits[s].metrics.placedOrder)/2)));require(["ms2h"],function(e){l.printResults(n==0?"Nothing to see here, move along!":"Last visit: "+e.getDMYfromTimestamp(n)+"</br>Avarage time spent: "+e.getHMS(r)+"</br>Avarage order time: "+e.getHMS(i))})},printResults:function(e){i.classList.remove("hidden"),i.innerHTML=e},measurmentsDone:function(){return[].every.call(o,function(e){return e.classList.contains("done")})}};return l}),define("session",[],function(){return{load:function(e){if(typeof sessionStorage.times=="undefined")return;var t=sessionStorage.times.split(",");document.querySelector("select").value=sessionStorage.place,document.querySelector("#pages").classList.toggle("active"),require(["ms2h"],function(e){document.querySelector(".curDate").innerHTML="Session from: "+e.getDMYfromTimestamp(parseInt(t[0]));for(var n=0;n<t.length;n++){var r=document.querySelector(".hiddenR");r.innerHTML+="@ "+e.getTime(parseInt(t[n])),r.classList.add("done"),r.setAttribute("data-time",parseInt(t[n])),r.classList.toggle("hiddenR")}var r=document.querySelector(".hiddenR");r.classList.toggle("hiddenR")})}}}),require(["UI","session"],function(e,t){e.addEvLis(),t.load()}),define("js/client",function(){});